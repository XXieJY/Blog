###  1、中国剩余定理简介
#### 1.1、物不知其数
&emsp;&emsp;我国古代算书*《孙子算经》*中有这样一题：*“今有物不知其数，三三数之余二，五五数之余三，七七数之余二，问物几何？”*书中给出的解答是：*“三三数之剩二，置一百四十；五五数之剩三，置六十三；七七数之剩二，置三十。并之，得二百三十三，以二百十减之，即得。”*
&emsp;&emsp;这个问题用数学表达就是：求一个（最小的）数x，满足`x = 2 (mod 3)`且`x = 3 (mod 5)`且`x = 2 (mod 7)`。解法的思路是，先求以下三个数A、B、C，满足：
&emsp;&emsp;`A = 2 (mod 3)`且`A = 0 (mod 5)`且`A= 0 (mod 7)`；
&emsp;&emsp;`B = 0 (mod 3)`且`B = 3 (mod 5)`且`B = 0 (mod 7)`；
&emsp;&emsp;`C = 0 (mod 3)`且`C = 0 (mod 5)`且`C = 2 (mod 7)`；
其中`A = 140`；`B = 63`; `C = 30`，`A+B+C = 233`，再对`105（3*5*7）`取模，得23即为所求。
&emsp;&emsp;这个问题可能是最早的一元线性同余方程组问题问题，并给出了解答。后人在此基础上，不断完善该类问题的解法。

#### 1.2、大衍求一术
&emsp;&emsp;南宋，数学家**秦九韶**著有『数书九章』十八卷。全书共81道题，分为九大类：大衍类、天时类、田域类、测望类、赋役类、钱谷类、营建类、军旅类、市易类。**大衍求一术**是求解大衍问题的一类方法，大衍问题源于上述的*物不是其数*问题，属于现代数论中的一次同余方程组求解问题。
&emsp;&emsp;对于上述问题中的A、B、C的值是怎么求出来的，《孙子算经》中没有具体讲述，而《数书九章》中给出了计算方法。对于A，我们先求出A1，使得A1满足:`A1 = 1 (mod 3)`且`A1 = 0 (mod 5)`且`A1 = 0 (mod 7)`,则`A = A1 * 2`。具体的做法请继续阅读下一节内容。

### 2、线性同余方程组
#### 2.1、中国剩余定理解法
&emsp;&emsp;问题描述：求出方程组`x = ai (mod mi)（0 <= i < n）`的解。其中m1，m2，m3，...，mi两两互质。解法如下：
&emsp;&emsp;令`M = m0 * m1 * ... * mi`，`Gi = M / ai`，求ki，使得`ki * Gi = 1 (mod ai)`。对于本文1.2节里面的`A1`，就是`k1 * G1`，`G1`保证了`A1`模其他数为0，只要再求得`k1`即可得到`A1`。
&emsp;&emsp;这样，求解同余方程组的问题，就转化为了求解ki，**大衍求一术**的做法是利用`gi(gi = Gi (mod ai))`与`ai`辗转相除求得，而我们在编程中，可以通过从`1`到`ai-1`枚举求得ki。当然了，如果是手算，可以求`ki * gi = 1 (mod ai)`，毕竟`gi`更小便于计算。求完之后，方程组的最小解是`sum(ki * Gi * ai) mod M`，其中`sum`表示求和。

#### 2.2、拓展欧几里得解法
&emsp;&emsp;基于拓展欧几里得算法，我们可以编程解决该问题，代码如下：
``` cpp

int CRT(int a[], int m[], int n){//n表示方程个数
    int M = 1;
    for(int i = 0; i < n; ++i)
        M *= m[i];
    int ret = 0;
    for(int i = 0; i < n; ++i){
        int x, y;
        int tm = M / m[i];
        extend_gcd(tm, m[i], x, y);
        ret = (ret + tm * x * a[i]) % M;
    }
    return (ret + M) % M;
}

```
&emsp;&emsp;其中，a和m为上文2.1节中方程组的参数，n为方程个数，函数返回结果为最小解。

### References
* 《算法导论》31.5 中国剩余定理
* 《ACM国际大学生程序设计竞赛算法与实现》1.2.4 中国剩余定理